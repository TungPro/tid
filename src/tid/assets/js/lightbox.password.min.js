
$.fn.passwordStrength = function (options) {
    return this.each(function () {
        var that = this;
        that.opts = {};
        that.opts = $.extend({}, {
            images: Array(IMAGE_URL + '/graphics/security_level_0.gif', IMAGE_URL + '/graphics/security_level_1.gif', IMAGE_URL + '/graphics/security_level_2.gif', IMAGE_URL + '/graphics/security_level_3.gif', IMAGE_URL + '/graphics/security_level_4.gif')
        }, options);
        that.messageDiv = $(that.opts.messageDiv);
        that.imageTag = $(that.opts.imageTag);
        var noofchar = /^.*(?=.{6,}).*$/;
        var bad = /^((^[a-z]{6,}$)|(^[A-Z]{6,}$)|(^[a-zA-Z]{6,}$)|(^[\d]{6,}$)|(^[\W_]{6,}$))$/;
        var weak = /^([a-z]{1,}\d{1,})|(^[a-zA-Z0-9]{1,}$)|([A-Z]{1,}\d{1,})|(\d{1,}[a-z]{1,})|(\d{1,}[A-Z]{1,})|(\d{1,}\W{1,})|(\W{1,}\d{1,})|([A-Z]{1,}\W{1,})|(\W{1,}[A-Z]{1,})|([a-z]{1,}\W{1,})|(\W{1,}[a-z]{1,})$/;
        var strong = /^([a-z]{1,}\d{1,}\W{1,})|([a-z]{1,}\W{1,}\d{1,})|(\d{1,}\W{1,}[a-z]{1,})|(\d{1,}[a-z]{1,}\W{1,})|\W{1,}([a-z]{1,}\d{1,})|\W{1,}\d{1,}([a-z]{1,})|([A-Z]{1,}\d{1,}\W{1,})|([A-Z]{1,}\W{1,}\d{1,})|(\d{1,}\W{1,}[A-Z]{1,})|(\d{1,}[A-Z]{1,}\W{1,})|\W{1,}([A-Z]{1,}\d{1,})|\W{1,}\d{1,}([A-Z]{1,})$/;
        var best = /^.*(?=.{6,})(?=.*[A-Z])(?=.*[a-z])(?=.*[\d])(?=.*[\W]).*$/;
        $(this).blur(function () {
            var password = $.trim(this.value);
            if (false == noofchar.test(password)) {
                this.imageTag.attr("src", this.opts.images[0])
            } else if (best.test(password)) {
                this.imageTag.attr("src", this.opts.images[4])
            } else if (strong.test(password)) {
                this.imageTag.attr("src", this.opts.images[3])
            } else if (bad.test(password)) {
                this.imageTag.attr("src", this.opts.images[1])
            } else if (weak.test(password) == true) {
                this.imageTag.attr("src", this.opts.images[2])
            }
        });
        $(this).keyup(function () {
            var password = $.trim(this.value);
            if (false == noofchar.test(password)) {
                this.imageTag.attr("src", this.opts.images[0])
            } else if (best.test(password)) {
                this.imageTag.attr("src", this.opts.images[4])
            } else if (strong.test(password)) {
                this.imageTag.attr("src", this.opts.images[3])
            } else if (bad.test(password)) {
                this.imageTag.attr("src", this.opts.images[1])
            } else if (weak.test(password) == true) {
                this.imageTag.attr("src", this.opts.images[2])
            }
        })
    })
};