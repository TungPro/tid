$(function (a) {
    a("#password").passwordStrength({
        imageTag: a("#security_level_image")
    });
    a("input.Tooltip").focus(function () {
        var b = this.id;
        a("li.inform").hide();
        if ("lastname" == b || "firstname" == b) b = "displayname";
        a("#t_" + b).show()
    }).focusout(function () {
        a("li.inform").hide()
    });
    a("#email").blur(function () {
        "email" == this.id && a(this).val(a.trim(a(this).val()))
    });
    a("#frmRegister").validate({
        onkeyup: !1,
        rules: {
            email: {
                checkEmpty: !0,
                email: !0,
                checkEmailExist: !0
            },
            password: {
                required: !0,
                rangelength: [6, 32]
            },
            confirmpassword:{
            	required: !0,
                rangelength: [6, 32],
                checkEqualPassword: !0
            },
            firstname: {
                checkEmpty: !0,
                NoSpecialCharacters: !0
            },
            lastname: {
                checkEmpty: !0,
                NoSpecialCharacters: !0
            },
            captcha: {
                required: !0,
                rangelength: [6, 6]
            },
            year:{
            	required: !0,
            	checkDateValid: !0
            },
            
            month:{
            	required: !0,
            	checkDateValid: !0
            },
            day:{
            	required: !0,
            	checkDateValid: !0
            },
            gender: {
            	required: !0
            }
        },
        messages: {
            email: {
                checkEmpty: "Bạn chưa nhập địa chỉ email.",
                email: "Địa chỉ email không hợp lệ. Vui lòng nhập địa chỉ khác.",
                checkEmailExist: "checkEmailExist"
            },
            password: {
                required: "Bạn chưa nhập mật khẩu.",
                rangelength: "Độ dài mật khầu phải từ 6-32 ký tự."
            },
            confirmpassword: {
                required: "Bạn chưa nhập mật khẩu.",
                rangelength: "Độ dài mật khầu phải từ 6-32 ký tự.",
                checkEqualPassword: "Mật khẩu xác nhận không đúng. Vui lòng nhập lại."
            },
            lastname: {
                checkEmpty: "Bạn chưa nhập họ và tên.",
                NoSpecialCharacters: "Họ của bạn không được chứa các ký tự đặc biệt."
            },
            firstname: {
                checkEmpty: "Bạn chưa nhập họ và tên.",
                NoSpecialCharacters: "Tên của bạn không được chứa các ký tự đặc biệt."
            },
            captcha: {
            	required: "Bạn chưa nhập mã xác nhận.",
            	rangelength: "Độ dài mã xác nhận không đúng!"
            },
            day:{
            	required: "Bạn chưa chọn ngày.",
            	checkDateValid: "Ngày sinh không chính xác. Vui lòng kiểm tra lại."
            },
            month:{
            	required: "Bạn chưa chọn tháng.",
            	checkDateValid:  "Ngày sinh không chính xác. Vui lòng kiểm tra lại."
            },
            year:{
            	required: "Bạn chưa chọn năm.",
            	checkDateValid:  "Ngày sinh không chính xác. Vui lòng kiểm tra lại."
            },
            gender: {
            	required: "Bạn chưa chọn giới tính."
            }
        },
        errorPlacement: function (b, c) {
            a("#error_captcha").text("");
            if("day" == c.attr("id") || "month" == c.attr("id") || "year" == c.attr("id") ){
            	a("#error_dob").text(""), b.appendTo("#error_dob");
            	
            }else if ("email" == c.attr("id")) {
                if ("checkEmailExist" == b.text()) return !1;
                a("#error_email").html("");
                b.appendTo("#error_email")
            } else "password" == c.attr("id") ? b.appendTo("#error_password") : "lastname" == c.attr("id") || "firstname" ==
                c.attr("id") ? (a("#error_fullname").text(""), b.appendTo("#error_fullname")) : "captcha" == c.attr("id") ? b.appendTo("#error_captcha") : "confirmpassword" == c.attr("id") ? b.appendTo("#error_confirmpassword") : "gender" == c.attr("id") ? b.appendTo("#error_gender") : b.insertAfter(c)
        },
        success: function (b) {
            "email" == b.attr("for") && a("#icon_email").find("img").addClass("icon01")
        }
    });
    a.validator.addMethod("checkEqualPassword", function (b, c) {
    	pass = a("#password").val();
        return b == pass;
    }, "");
    
    a.validator.addMethod("NoSpecialCharacters", function (a, c) {
        return a.match(/[#;@&,\-\_\+\*~':"!\^\$\[\]\(\)=>|\/\\]/g) ? !1 : !0
    }, "");
    a.validator.addMethod("checkEmailExist", function (b, c) {
        chkEmailResult = !1;
        a.trim(b) && a.ajax({
            type: "POST",
            cache: !1,
            async: !1,
            url: HOST_URL + "/register/checkemailexists",
            data: "email=" + b,
            dataType: "json",
            success: function (b) {
                b.exist ? (chkEmailResult = !1, a("#error_email").html("Email này đã tồn tại trong hệ thống.")) : (a("#error_email").html(""), chkEmailResult = !0)
            }
        });
        return chkEmailResult
    }, "");
    a.validator.addMethod("checkDateValid", function (b, c) {
        var d = a.trim(a("#day").val()),
            e = a.trim(a("#month").val()),
            f = a.trim(a("#year").val());
        if ("" == d || "" == e || "" == f) return !1;
        source_date = new Date(f, e - 1, d);
        return d != source_date.getDate() || e != source_date.getMonth() + 1 ? !1 : !0
    }, "");
    a.validator.addMethod("checkEmpty", function (b, c) {
        "email" == c.getAttribute("id") && (c.value = a.trim(b), a("#icon_email").find("img").attr("class", "ico09-img ico-status"));
        return a.trim(b) && 0 < b.length && b != c.getAttribute("title")
    }, "");
    show_captcha();
    "" != a.trim(a("#error_captcha").text()) ? a("#captcha").focus() : a("#email").focus()
});

function show_captcha() {
    $.ajax({
        type: "GET",
        url: location.protocol + "//" + location.hostname + "/captcha/show",
        success: function (a) {
            $("#box_captcha").html(a)
        }
    })
};